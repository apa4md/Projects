# Etcd cluster
## Запускаем кластер etcd из 3 нод в докере
root@LAPTOP-IKH1SEPG:~# docker ps
CONTAINER ID   IMAGE                 COMMAND                  CREATED         STATUS         PORTS                                              NAMES
a2c084a00eb2   bitnami/etcd:latest   "/opt/bitnami/script…"   3 seconds ago   Up 2 seconds   0.0.0.0:32379->2379/tcp, 0.0.0.0:32380->2380/tcp   etcd_node3
3190c8a57a10   bitnami/etcd:latest   "/opt/bitnami/script…"   8 minutes ago   Up 5 minutes   0.0.0.0:22379->2379/tcp, 0.0.0.0:22380->2380/tcp   etcd_node2
73e37e911619   bitnami/etcd:latest   "/opt/bitnami/script…"   9 minutes ago   Up 2 minutes   0.0.0.0:12379->2379/tcp, 0.0.0.0:12380->2380/tcp   etcd_node1

смотрим статус кластера
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
|       ENDPOINT        |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
| http://10.3.36.2:2379 | 13111a2e9b7bc71c |  3.5.11 |   20 kB |      true |      false |         3 |         13 |                 13 |        |
| http://10.3.36.3:2379 | 31c930f7c2d03771 |  3.5.11 |   20 kB |     false |      false |         3 |         13 |                 13 |        |
| http://10.3.36.1:2379 | a06389418e875a22 |  3.5.11 |   20 kB |     false |      false |         3 |         13 |                 13 |        |
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+

выключаем вторую ноду(мастера), видим, что теперь мастером становится первая нода
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
|       ENDPOINT        |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
| http://10.3.36.3:2379 | 31c930f7c2d03771 |  3.5.11 |   20 kB |     false |      false |         4 |         14 |                 14 |        |
| http://10.3.36.1:2379 | a06389418e875a22 |  3.5.11 |   20 kB |      true |      false |         4 |         14 |                 14 |        |
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
включаем вторую ноду, она возвращается в кластер
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
|       ENDPOINT        |        ID        | VERSION | DB SIZE | IS LEADER | IS LEARNER | RAFT TERM | RAFT INDEX | RAFT APPLIED INDEX | ERRORS |
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+
| http://10.3.36.2:2379 | 13111a2e9b7bc71c |  3.5.11 |   20 kB |     false |      false |         4 |         17 |                 17 |        |
| http://10.3.36.3:2379 | 31c930f7c2d03771 |  3.5.11 |   20 kB |     false |      false |         4 |         17 |                 17 |        |
| http://10.3.36.1:2379 | a06389418e875a22 |  3.5.11 |   20 kB |      true |      false |         4 |         17 |                 17 |        |
+-----------------------+------------------+---------+---------+-----------+------------+-----------+------------+--------------------+--------+